FROM ubuntu:18.04
ENV LC_ALL C.UTF-8

# Install SSH server
RUN apt-get update -y

RUN apt-get install wget -y &&\
    wget http://security.ubuntu.com/ubuntu/pool/main/s/sudo/sudo_1.8.31-1ubuntu1.5_amd64.deb && \
    dpkg -i sudo_1.8.31-1ubuntu1.5_amd64.deb

RUN apt-get install -y --no-install-recommends openssh-server && \
    mkdir -p /run/sshd && \
    rm -rf /var/lib/apt/lists/*

RUN useradd -mU ctf && \
    echo "root:root" | chpasswd && \
    echo "ctf:ctf" | chpasswd && \
    echo "ctf ALL=(ALL:ALL) NOPASSWD: sudoedit /etc/import.txt" && \
    chsh -s /bin/bash ctf


RUN touch /etc/import.txt

EXPOSE 22
CMD ["/usr/sbin/sshd", "-D"]